<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <title>TiKirjanpito</title>
  <%= javascript_include_tag :defaults %>
  <%= stylesheet_link_tag 'scaffold' %>
  <%= stylesheet_link_tag 'style' %>
  <link rel="shortcut icon" href="/images/icon.gif" type="image/x-icon" />
</head>
<body>

<div id="container-page">

  <div class="header_top">

  <div style="float: right;">
		<div style="padding: 0.6em">
		<%=form_tag request.path, :method => :get %>
		Fiscal period:
		<%=select_tag "new_fiscal_period", 
			FiscalPeriod.find(:all).collect{ |f|
				"<option value='"+f.id.to_s+"'"+
				(session[:fiscal_period_id] == f.id.to_s ? " selected='selected'" : "" )+
				">"+f.startdate.year.to_s+"</option>"},
			:onchange => "this.form.submit()"%>
		<%=submit_tag "Change" %>
		</form>
		</div>
  </div>

  <a href="/"><img src="/images/logo_top.gif" alt="Logo" /></a>
  </div>
  
  <div class="header_bottom">
    <% if logged_in? %>
<% if false %>
    <div class="header_menu"><%= link_to "B.Accounts", {:controller => :budget_accounts}, {"class" => "header"} %></div>
    <div class="header_menu"><%= link_to "Account&nbsp;types", {:controller => :account_types}, {"class" => "header"} %></div>
    <div class="header_menu"><%= link_to "Fiscal&nbsp;Periods", {:controller => :fiscal_periods}, {"class" => "header"} %></div>
    <div class="header_menu"><%= link_to "Sign-up", {:controller => :users, :action => :new}, {"class" => "header"} %></div>
<% end %>
<%
def top_button(link, desc)
	return '<div ' + 
		(params[:controller] == link.to_s ? 
			'class="header_menu_selected"' : 
			'class="header_menu"') + 
		'>' + 
		link_to(desc, {:controller => link }, {"class" => "header"}) + 
		'</div>'
end
%>
		<%=top_button(:help, "Help")%>
		<%=top_button(:users, "Users") if !@current_user.nil? && @current_user.level >= 2 %>
		<%=top_button(:entries, "Entries")%>
		<%=top_button(:invoices, "Invoices")%>
		<%=top_button(:budgets, "Budgets")%>
		<%=top_button(:accounts, "Accounts")%>
    <% else %>
    <!-- <div><%= link_to "Login", {:controller => :sessions, :action => :new}, {"class" => "header"} %></div> -->
    <% end %>
  </div>
    <div style="float: right;">
    <% if logged_in? %>
    <%= link_to "Logout", "/logout" %>
    <% end %>
  </div>
  
  <div id="content">
    <p style="color: green"><%= flash[:notice] %></p>
    <%= yield %>
  </div>
  
  <div id="footer">
  Copyright Tietokilta ry 2007
  </div>

</div>

</body>
</html>
